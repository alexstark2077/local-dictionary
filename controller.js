"use strict";const controlBtnsContainer=document.querySelector(".controls"),controlBtns=document.querySelectorAll(".controls__btn"),formAddNew=document.querySelector(".form__add-new"),formAddNewBtn=document.querySelector(".form__add-new-submit"),formAddNewInputs=document.querySelectorAll(".form__input"),formAddNewRadios=document.querySelectorAll(".form__input-tag-check-old"),formAddNewExample=document.querySelector(".form__input--example"),formAddNewMeaning=document.querySelector(".form__input--meaning"),formAddNewSynonyms=document.querySelector(".form__input--synonyms"),formAddNewWord=document.querySelector(".form__input--word"),results=document.querySelector(".results"),resultsRegular=document.querySelector(".results__regular"),exportBtn=document.querySelector(".export__btn"),changeViewBlock=document.querySelector(".change-view"),entriesCount=document.querySelector(".entries-count span"),controlsBox=document.querySelector(".controls__box"),firstControlBtn=document.querySelector(".controls__btn"),seeAllBtn=document.querySelector(".see-all"),Logic=new App,Visual=new Visuals;function handleEvents(){Visual.handleFormSubmit(),Visual.handleAddBtnClick(addOrEditEntry),Visual.handleTabSwitch(switchActiveTabBtn),Visual.handleExportBtnClick(reactToExportBtnClick),Visual.handleChangeViewBtnClick(reactToChangeViewBtnClick),Visual.handleChangeColorsBtnClick(),Visual.handleEditBtnClick(reactToEditBtnClick),Visual.handleTagBtnClick(reactToTagBtnClick),Visual.handleSeeAllBtnClick(reactToSeeAllBtnClick),Visual.handleMiniatureClick(reactToMiniatureClick)}function allFieldsFilled(){const e=Array.from(formAddNewInputs).every((e=>e.value.length>0)),t=Array.from(formAddNewRadios).some((e=>e.checked));return!0===e&&!0===t}function addOrEditEntry(){allFieldsFilled()||Visual.renderMsg("Some error happened... ðŸ˜¢","error"),allFieldsFilled()&&"Add"===formAddNewBtn.textContent&&(Logic.pushEntry([formAddNewExample.value,formAddNewMeaning.value,formAddNewSynonyms.value,formAddNewWord.value,Visual.readTags()]),Visual.renderMsg("âœ… submitted successfully!","success")),allFieldsFilled()&&"Edit"===formAddNewBtn.textContent&&(Logic.editEntry([formAddNewExample.value,formAddNewMeaning.value,formAddNewSynonyms.value,formAddNewWord.value,Visual.readTags()]),Visual.renderMsg("âœ… edited successfully!","success")),Visual.clearFields()}function switchActiveTabBtn(e=firstControlBtn){const t=e.target;controlBtns.forEach((e=>e.classList.remove("active"))),t.classList.add("active"),"See All"===t.textContent&&(Visual.toggleSecondTabVisibility(),formAddNew.style.display="none",Visual.clearFields(),Visual.renderDictContents(Logic.getDict().reverse()),Visual.setUpView(Logic.getState().viewChoice,Logic.getDict())),"Add New"===t.textContent&&(Visual.toggleSecondTabVisibility(),formAddNew.style.display="flex",results.classList.remove("results--grid"))}async function reactToExportBtnClick(e){await Logic.exportAll()}function reactToEditBtnClick(e){const t=Logic.getOriginalIndex(+e.dataset.id),l=Logic.getDict()[t];Visual.editMode(l)}function reactToTagBtnClick(e){const t=Logic.getDict().filter((t=>t.tags.includes(e)));if("two-columns"===results.dataset.view)return document.querySelector(".results__all-miniatures").innerHTML="",t.forEach((e=>{const t=`<div class="results__entry-miniature">${e.word}</div>`;document.querySelector(".results__all-miniatures").insertAdjacentHTML("beforeend",t)})),document.querySelectorAll(".results__entry-miniature").length===Logic.getDict().length&&(seeAllBtn.style.display="none"),document.querySelector(".results__see-all").style.display="block",Visual.handleResultsSeeAllClick(reactToResultsSeeAllClick),void Visual.selectActiveMiniature();results.innerHTML="",Visual.renderDictContents(t),seeAllBtn.style.display="block"}function reactToResultsSeeAllClick(){document.querySelector(".results__all-miniatures").innerHTML="",Logic.getDict().forEach((e=>{const t=`<div class="results__entry-miniature">${e.word}</div>`;document.querySelector(".results__all-miniatures").insertAdjacentHTML("beforeend",t)})),Visual.selectActiveMiniature("clearInput")}function reactToSeeAllBtnClick(){results.innerHTML="",Visual.renderDictContents(Logic.getDict().reverse()),seeAllBtn.style.display="none"}function reactToChangeViewBtnClick(e){if("rows"===e||"grid"===e)return Visual.setUpView(e,Logic.getDict()),Logic.changeViewChoice(e),void Logic.saveStateLocally();const t=Logic.getOnlyWords();document.querySelector(".results__one").innerHTML=Visual.getEntryHTML(Logic.getDict()[0]),Visual.emphasizeWord(Logic.getDict()[0]),t.forEach((e=>{const t=`<div class="results__entry-miniature">${e}</div>`;document.querySelector(".results__all-miniatures").insertAdjacentHTML("beforeend",t)})),document.querySelectorAll(".results__entry-miniature").length===Logic.getDict().length&&(seeAllBtn.style.display="none"),document.querySelector(".results__entry-miniature").classList.add("active"),Visual.handleMiniatureInput(reactToMiniatureInput),Visual.setUpView(e,Logic.getDict()),Logic.changeViewChoice(e),Logic.saveStateLocally()}function reactToMiniatureClick(e){const t=Logic.getOriginalIndexByWord(e);document.querySelector(".results__one").innerHTML=Visual.getEntryHTML(Logic.getDict()[t]),Visual.emphasizeWord(Logic.getDict()[t])}function reactToMiniatureInput(e){if(0===e.length)return document.querySelector(".results__all-miniatures").innerHTML="",Logic.getDict().forEach((e=>{const t=`<div class="results__entry-miniature">${e.word}</div>`;document.querySelector(".results__all-miniatures").insertAdjacentHTML("beforeend",t)})),document.querySelector(".results__see-all").style.display="none",void Visual.selectActiveMiniature("clearInput");if(e.length<3)return;const t=Logic.getDict().filter((t=>t.word.includes(e)));document.querySelector(".results__all-miniatures").innerHTML="",0!==t.length?(document.querySelector(".results__entry-message")?.remove(),document.querySelector(".results__see-all").style.display="block",t.forEach((e=>{const t=`<div class="results__entry-miniature">${e.word}</div>`;document.querySelector(".results__all-miniatures").insertAdjacentHTML("beforeend",t)})),document.querySelector(".results__one").innerHTML=Visual.getEntryHTML(t[0]),Visual.emphasizeWord(t[0]),document.querySelector(".results__entry-miniature")?.classList.add("active")):document.querySelector(".results__all-miniatures").insertAdjacentHTML("beforeend",'<div class="results__entry-message">Nothing found...</div>')}handleEvents();